# 快速上手TPM2.0
这一章主要描述TPM的应用。因为TPM2.0继承了TPM1.2中已有的功能，所以我们首先介绍TPM1.2的相关特性及其应用。然后我们进而介绍TPM2.0中新增加的特性和典型应用场景。

我们在第一章中已经提到，随着互联网的兴起，解决随之而来的安全问题，特别是解决电子商务中的安全问题是设计TPM的主要驱动力。一个基于硬件的标准的安全解决方案是当下迫在眉睫的需求。与此同时，因为没有历史包袱，所以这对安全研究者来说是一个从头到尾设计一个全新安全系统的黄金契机。长期以来，人们都期待一个基础性的安全架构，它能用于支撑新的安全技术的建立，而不是仅仅为了解决安全问题的安全补丁。

TCG在TPM1.2的设计中第一次尝试解决以下工业界中常见的问题：
* 设备身份：在TPM发布之前，设备通常用MAC地址和IP地址作为自己的身份，这并不安全。
* 密钥的安全生成：具备一个硬件随机数生成器对密钥的生成是非常有利的。许多安全解决方案因为密钥生成的质量不高而被破解。
* 密钥的安全存储：TPM能够安全存储高质量的密钥并让它们免于软件攻击，这是TPM带给设备的一个重大安全优势。
* NVRAM存储：当IT组织收到一个全新设备时，它们常常根据自己的标准流程格式化硬盘并重新部署软件。NVRAM可以让TPM一直保存证书而不依赖外部存储。
* 设备健康认证：在TPM出现之前，IT通常使用软件来检测系统的健康（安全）状态。但是，当整个软件系统被攻破的情况下，软件的报告就不可信赖了。

TPM2.0在1.2版本的基础上又增加了更多：
* 算法灵活性：因为有些算法的强度实际上比预期弱，所以未来可能需要修改。TPM2.0可以在不用修改规范前提下修改算法，这一点已经多次提到了。
* 增强的授权模式：这个功能通过增加授权策略的方式统一了TPM实体的授权方式。授权策略可以支持多元素多用户认证。除此之外，还包括策略管理的功能。
* 快速密钥加载：密钥加载是一个很费时的过程，因为密钥常常被加密存储。新的TPM规范使用对称密钥来加密密钥，相对于之前的非对称密钥加密，速度大大提高。
* 更稳定的PCR：过去，将密钥和设备状态绑定（状态常常由PCR存储，这里绑定可以简单理解为只有当某个PCR的值是某一个已知的好的状态时，才允许访问密钥）在一起会引起一些管理上的问题。因为通常情况下，假设一个密钥和存储平台启动过程测量值的PCR绑定，当启动固件因为正常更新影响PCR的值时，相应的密钥就要修改或者重新绑定。这个问题在新版本的TPM中已经不是问题了。
* 灵活的管理功能：各种各样的授权被分门别类，满足了对TPM资源进行灵活管理的需求。
* 通过名称识别资源：TPM1.2中对资源的间接访问产生了安全隐患。这问题在新的规范中通过使用资源名称来解决，名称本身经过基于密码学的安全处理。

已有超过10亿符合TPM1.2规范的TPM被部署在计算机系统中，单从这一点来看，无疑TPM1.2时成功的。而TPM2.0在1.2基础上做了更进一步的扩展。目前许多厂商正在实现满足TPM2.0规范的TPM，并且已经在部署了（2018的现在，新发布的商用机中应该都是TPM2.0了）。除了硬件TPM，一些厂商也在开发软件实现的TPM（来来来，Intel KPT，IMB vTPM，GOOGLE等大厂产品了解一下）。

## TPM1.2应用场景
一般来讲，TPM2.0的设计能够胜任所有TPM1.2芯片能做的事情。因此，考虑到当前的应用软件可以在TPM2.0芯片上运行，我们首先来介绍已经应用TPM1.2功能的应用。

### 身份认证
TPM1.2作为第一代嵌入式安全芯片，第一个得到应用的预期的功能是设备身份功能。首先来介绍一下具有类似功能的智能卡。智能卡的芯片中嵌入了用来标识其身份的私钥。同时还有口令或者PIN码用于验证智能卡用户身份。私钥和口令共同实现了“你拥有什么”，“你知道什么”这两方面的认证。但是只要知道一个智能卡的口令或者PIN码，它就没有办法阻止被多个人使用。也没有一种方法使智能卡和一个特定的设备实现绑定，当然如果这个智能卡是用来认证用户而不是认证设备的时候，这对智能卡来说是一种优势，因为一个软件的用户很可能会在不同的机器上使用相同的软件服务，这样以来一张卡就可以解决认证问题（后面也有类似的说明）。

通过在个人电脑中植入私钥的方法，可以让设备拥有身份。这对于IT组织来说是是一个巨大的利好，因为这样可以很方便的管理软件的加载和实施安全防护（这个乍一看，完全不知道怎么回事啊）。
### 加密
### 密钥存储
### 随机书生成器
### NVRAM存储
### 平台配置寄存器
### 隐私保护
## TPM2.0新增的应用场景
### 算法灵活性
### 增强的授权模式
### 快速密钥加载
### 更稳定的PCR
### 灵活的管理功能
### 通过名称识别资源
## 小结
