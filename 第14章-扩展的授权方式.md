# 扩展的授权方式
TPM2.0已经统一了所有由TPM控制的实体的授权方式。前面的章节已经讨论了口令和HMAC授权需要使用的授权数据。这一章将详细讨论TPM的一个新型的最强大的授权方式，开始我们将说明为什么在TPM中增加这种授权方式，然后我们将层层揭开这种授权方式的多层面纱。

这种新的授权方式有许多功能。总结来说就是，如果一个用户想限制一个实体只能在某些特定情况下才能被使用，使用这种方式就有可能实现。所有针对这个实体使用的限制的总和就叫做一个policy。扩展的授权（EA）Policy可以迅速变得复杂。因此，这一章的描述是渐进式的，最开始先介绍一个非常简单的Policy，然后逐步地增加难度。这个过程是通过探究如何实现以下功能来完成的：
* 简单断言。
* 基于命令的断言。
* 多因素授权。
* 多用户/组合授权。
* 可以在中途修改的灵活Policy。

纵观本章内容，你可以看到在大多数情况下会用到的实用Policy的例子。最后我们会发现创建Policy与使用Policy不同，所以你会了解到一个用户怎样满足一个Policy；此时你也就会明白为什么Policy是安全的。

最后，我们会介绍一些用于解决特殊问题的Policy。这一节可能会激发你的创造性——你将意识到有比你想象中更多的方式来使用Policy。

首先，我们通过比较EA Policy和使用口令授权的异同来开始本章的学习。

## Policy和口令
## 为什么使用扩展的授权方式？
TPM中EA的设计初衷是为了解决TPM实体授权管理的基本问题。让所有的TPM实体都以同样的方式授权，这可以让我们更容易地学习如何使用TPM。同时，EA也允许用户定义授权Policy来解决如下的问题：
* 允许多种变化的授权（口令，生物信息等等）。
* 允许多因素的授权方式（要求多一种的授权类型）。
* 允许在不使用TPM的情况下创建Policy。Policy本身不包含任何秘密信息，所以可以完全由软件来创建。但是这并不等于满足一个Policy不需要秘密信息。
* 允许认证与一个实体相关联的Policy。用户应该能够知道使用一个实体时哪些授权是必须的。
* 允许多个用户或者角色来满足一个Policy。
* 允许限制某一个对象的特定角色的动作或者使用用户。
* 修正了PCR脆弱的问题。在TPM1.2中，如果一个实体被“锁定”到包含特定配置的一组PCR中，一旦配置不得不变化，那这个实体就不能使用了。

### 授权的多个变种
### 多元素认证
## 扩展的授权方式是怎样工作的？
## 创建Policy
### 简单的断言policy
#### 对象的口令（明文或者HMAC）
#### 另外一个对象的口令
#### 数字签名（比如智能卡）
#### PCR：机器的状态
#### 命令的Locality
#### TPM内部的状态（启动计数器和定时器）
#### NV内存区域的值
#### 外部设备的状体（GPS，指纹读卡器，以及其他）
#### 灵活的Policy（通用型）
#### 示例1：智能卡和口令
#### 示例2：一个密钥的policy只能使用一个口令来授权签名操作
#### 示例3：一个PC状态，一个口令，一个指纹
#### 示例4：用于一个启动周期的Policy
#### 示例5：灵活的PCR的Policy
#### 示例6：用于一组许可的Policy
#### 示例7：用于NV内存1-100的Policy
## 基于命令的断言
## 多元素认证
## 混合Policy：在一个Policy中使用逻辑OR
### 生成一个混合Policy
### 示例：一个用于工作或者家庭电脑的Policy
## 创建Policy时需要考虑的因素
### 终端用户角色
### 管理员角色
### 候补角色
### 办公室角色
### 家庭角色
## 使用Policy授权一个命令
### 启动Policy
### 满足Policy需要的条件
#### 简单断言和多因素断言
### 如果是混合Policy
### 如果是灵活的Policy（通配型）
#### 满足被允许的Policy
#### 改变灵活Policy中被允许的Policy
## 认证过的Policy
## 总结
